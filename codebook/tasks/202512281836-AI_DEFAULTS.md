This file is a diff of a feature specification. I want you to change the code to match the new spec.

# AI defaults

<diff file="codebook/AI_HELPERS.md">
```diff
diff --git a/codebook/AI_HELPERS.md b/codebook/AI_HELPERS.md
index a5be80e..a03473c 100644
--- a/codebook/AI_HELPERS.md
+++ b/codebook/AI_HELPERS.md
@@ -37,5 +37,11 @@ This is the task file: [TASK_FILE]
 codebook ai review claude ./codebook/tasks/YYYYMMDDHHMM-TITLE.md
 ```

+
+When no path is provided, all modified and untracked markdown files in the tasks directory are reviewed.
+```bash
+codebook ai review claude
+```
+
 --- BACKLINKS ---
 [README](README.md "codebook:backlink")
```
</diff>

---
After completing the task, please update the task file with:
- Description of the feature task that was requested
- Short description of the changes that were made and why
Include implemenentation details how the task was implemented.
Do not include code snippets. Only describe the functional changes that were made.
Do not remove diff lines from the task file.
--- FEATURE TASK ---
Add default path resolution to `codebook ai review` and `codebook task update` commands.

--- NOTES ---
When no path is provided, both commands should find all modified/untracked markdown files in the tasks directory.

--- SOLUTION ---
**Feature: Optional path arguments for `codebook ai review` and `codebook task update`**

Implemented default path resolution for both commands. When no path is provided, they automatically find and process all modified and untracked markdown files in the tasks directory.

**Changes to cli.py for `codebook ai review`:**

- Made the `path` argument optional (`required=False`)
- Added `_get_modified_task_files(tasks_dir)` function that uses git to find:
  - Modified files (staged and unstaged) via `git diff --name-only HEAD`
  - Untracked files via `git ls-files --others --exclude-standard`
- Extracted agent execution logic into `_run_agent_review()` helper function
- Updated `ai_review` to iterate over all found task files when no path is provided
- Updated `ai_help` to document the new optional path behavior

**Changes to cli.py for `codebook task update`:**

- Made both `task_file` and `scope` arguments optional (`required=False`)
- Extracted core update logic into `_update_single_task()` helper function
- When no `task_file` provided: finds all modified/untracked task files using `_get_modified_task_files()`
- When no `scope` provided: uses `watch_dir` from codebook.yml configuration
- Reuses the same `_get_modified_task_files()` function from AI helpers

**Behavior:**

`codebook ai review`:
- With path: Reviews the single specified file (existing behavior)
- Without path: Finds all modified/untracked .md files in tasks_dir, lists them, and reviews each sequentially
- Exit code: Returns non-zero if any review fails

`codebook task update`:
- With both args: Updates single task with specified scope (existing behavior)
- Without task_file: Updates all modified/untracked task files
- Without scope: Uses watch_dir from config as default scope
- Exit code: Returns non-zero if no tasks were updated

**Tests added for `codebook ai review`:**
- `test_ai_review_no_path_finds_no_files` - Empty tasks directory returns success
- `test_ai_review_no_path_with_untracked_files` - Finds and reviews untracked files
- `test_ai_review_no_path_with_modified_files` - Finds and reviews modified files
- `test_ai_review_no_path_reviews_all_files` - Reviews all found files sequentially
- `test_ai_review_no_path_propagates_failure` - Propagates non-zero exit codes

**Tests added for `codebook task update`:**
- `test_task_update_no_args_finds_no_files` - Empty tasks directory returns success
- `test_task_update_no_args_with_untracked_task_files` - Finds untracked task files
- `test_task_update_no_args_uses_default_scope` - Uses watch_dir from config

**Documentation updates:**
- Updated `AI_HELPERS.md` with example of calling without path
- Updated `TASKS.md` with example of calling `codebook task update` without arguments
- Fixed typo in AI_HELPERS.md: changed `codebook ai review code` to `codebook ai review claude`

--- REVIEW 202512281907 ---
**Review: Documentation accurately describes the implemented functionality**

The documentation updates in both `AI_HELPERS.md` and `TASKS.md` correctly describe the new default path resolution feature:

1. **AI_HELPERS.md** (line 41-44): Accurately states "When no path is provided, all modified and untracked markdown files in the tasks directory are reviewed" and provides the correct usage example.

2. **TASKS.md** (line 19-22): Accurately describes that "When no arguments are provided, all modified and untracked task files in the tasks directory are updated using the watch_dir from configuration as the default scope" with the correct `codebook task update` example.

3. **Implementation verification**: The cli.py code confirms:
   - Both commands have optional path arguments (`required=False`)
   - The `_get_modified_task_files()` function correctly identifies modified and untracked markdown files using git commands
   - Both commands iterate through found files and process them sequentially
   - Help text and docstrings accurately describe the new behavior
   - Exit codes are properly handled (non-zero when any operation fails)

The documentation and implementation are in sync. Users reading the docs will understand exactly how the commands behave with and without path arguments.

--- REVIEW 202512281915 ---
The changes successfully implement the default path resolution for `codebook ai review` and `codebook task update`.

1. **Implementation**: The `_get_modified_task_files` helper correctly identifies both modified and untracked markdown files in the tasks directory using git. The logic for both commands has been refactored to handle batch processing when arguments are missing, falling back to sensible defaults (configured `watch_dir` for scope, all modified tasks for task files).
2. **Documentation**: `AI_HELPERS.md` and `TASKS.md` have been updated with clear examples of the new optional path behavior.
3. **Tests**: New tests in `tests/test_cli.py` verify that the commands correctly find files when no arguments are provided and handle various git states (untracked, modified).

The implementation is clean, follows project conventions, and the documentation accurately reflects the changes.
